## 代码分析
`data.vsdx`对`scripts/test.html`里的js进行了详细的分析.

## Windbg调试IE8
打开IE8，把html拖进去，看到网页上显示"Spray done"就说明堆喷射成功了。此时打开任务管理器可以看到多个`iexplore.exe`进程，每个进程对应于一个选项卡，有一个选项卡的内存占用达到了约200MB，我们要attach的就是这个进程。

![](images/1.png)

准备好symbol file后，查看进程的堆信息：

![](images/2.png)

查看`00290000`处的堆信息：

![](images/3.png)

查看大小为`7ffe0`的堆块（这样大小的堆有0x191个）：

![](images/4.png)

可以看到每个堆块的`HEAP_ENTRY`都是`xxxx0018`. 查看`0c0c0c0c`所属的堆块：

![](images/5.png)

该堆块的起始地址应该是`0c0c0000`，使用`dd`命令查看内存(`dd`命令的地址被解释为虚拟地址)：

![](images/6.png)

前两个DWORD就是双向链表的前向和后向指针.

最后查看`0c0c0c0c`处的内存：

![](images/7.png)

实现了精准堆喷射.

附：!heap调试命令 [https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/-heap](https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/-heap)
